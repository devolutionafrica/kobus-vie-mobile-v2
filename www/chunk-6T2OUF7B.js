import{a as d}from"./chunk-W6C75AC7.js";import{a as _}from"./chunk-LCZUZPJB.js";import{a as p}from"./chunk-T3DK3MTE.js";import{c as l}from"./chunk-YZR4O2H4.js";import{N as m,Q as n,d as f}from"./chunk-R3JMOR4V.js";import{h}from"./chunk-LNJ3S2LQ.js";var u=class{constructor(e,t,i,r,o){this._codeFiliale=e,this._clientNumber=t,this._fullname=i,this._role=r,this._isFirstConnexion=o}get filiale(){return this._codeFiliale}set isFirstConnexion(e){this._isFirstConnexion=e===0}get nuClient(){return this._clientNumber}toJson(){return{codeFiliale:this._codeFiliale,clientNumber:this._clientNumber,fullname:this._fullname,role:this._role,isFirstConnexion:this._isFirstConnexion}}};var c=class{static build(e){return new u(e._CodeFiliale,e._NumeroClient,e._fullname,e._roles)}};var a=class{constructor(e,t,i){this._session=e,this.urlAPI=t,this.configUrlApi=i,this.message="",this.isAuth=!1,this.authBehaviorSubject=new f(this.authObject)}signIn(e){return h(this,null,function*(){return yield this.urlAPI.authUser(e).then(t=>t.Statut===200?(this.createAuthInstance(t),this.updateBehaviorSubject(),this.message="Operation success (^_^)",!0):(this.message="Login ou Mot de passe incorrect (!_!)",!1)).catch(t=>(this.message="Erreur lors de la connexion avec la service (O_*)",!1))})}codeApporteurVerification(e){return h(this,null,function*(){return yield this.configUrlApi.verificationCodeApporteur(e).then(t=>t[0].CodeApporteur!=null).catch(t=>(this.message="Erreur lors de la connexion avec la service (O_*)",!1))})}createAuthInstance(e){this.authObject=c.build(e.InfoUser),this.authObject.isFirstConnexion=e.FirstConnect,this.isAuth=!0}updateBehaviorSubject(){this.authBehaviorSubject.next(this.authObject)}isUserFirstConnexion(){return this._session.storeValue(l.AUTH).isFirstConnexion}isConnected(){return this._session.storeValue(l.AUTH)!==null}logOut(){this.isAuth?(this.authBehaviorSubject.unsubscribe(),this.message="Utilisateur bien deconnect\xE9 (^_^)",this.isAuth=!1):this.message="Vous devez vous connect\xE9 (!_!)"}changUserPassword(e){return this.urlAPI.updateUserPassword(e).then(t=>(console.log("Coool :::> ",t),t)).catch(t=>console.log("Error detected :::> ",t))}};var N=(()=>{let e=class e extends a{constructor(i,r,o){super(i,r,o),this.extranetAPI=r,this.extranetConfigAPI=o}auth(i){return this.signIn(i)}codeApporteurVerif(i){return this.codeApporteurVerification(i)}isFirstConnexion(){return this.isUserFirstConnexion()}createNewPassword(i){return this.extranetAPI.updateUserPassword(i)}disconnect(){this.logOut()}};e.\u0275fac=function(r){return new(r||e)(n(p),n(d),n(_))},e.\u0275prov=m({token:e,factory:e.\u0275fac,providedIn:"root"});let s=e;return s})();export{N as a};
