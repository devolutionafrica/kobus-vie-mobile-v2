import{$ as E,Ca as te,E as B,Ea as ne,H as G,N as c,O as _,P as D,Q as l,U as ee,da as j,h as b,j as L,k as x,n as O,o as U,p as Y,x as k,xb as se,ya as H,z as m}from"./chunk-R3JMOR4V.js";import{a as K,g as o}from"./chunk-LNJ3S2LQ.js";var d=class{},$=(()=>{let t=class t extends d{getTranslation(e){return b({})}};o(t,"\u0275fac",(()=>{let e;return function(i){return(e||(e=E(t)))(i||t)}})()),o(t,"\u0275prov",c({token:t,factory:t.\u0275fac}));let s=t;return s})(),C=class{},q=(()=>{let t=class t{handle(e){return e.key}};o(t,"\u0275fac",function(n){return new(n||t)}),o(t,"\u0275prov",c({token:t,factory:t.\u0275fac}));let s=t;return s})();function I(s,t){if(s===t)return!0;if(s===null||t===null)return!1;if(s!==s&&t!==t)return!0;let u=typeof s,e=typeof t,n,i,a;if(u==e&&u=="object")if(Array.isArray(s)){if(!Array.isArray(t))return!1;if((n=s.length)==t.length){for(i=0;i<n;i++)if(!I(s[i],t[i]))return!1;return!0}}else{if(Array.isArray(t))return!1;a=Object.create(null);for(i in s){if(!I(s[i],t[i]))return!1;a[i]=!0}for(i in t)if(!(i in a)&&typeof t[i]<"u")return!1;return!0}return!1}function f(s){return typeof s<"u"&&s!==null}function y(s){return A(s)&&!Z(s)&&s!==null}function A(s){return typeof s=="object"}function Z(s){return Array.isArray(s)}function Q(s){return typeof s=="string"}function ae(s){return typeof s=="function"}function J(s,t){let u=Object.assign({},s);return A(s)?(A(s)&&A(t)&&Object.keys(t).forEach(e=>{y(t[e])?e in s?u[e]=J(s[e],t[e]):Object.assign(u,{[e]:t[e]}):Object.assign(u,{[e]:t[e]})}),u):J({},t)}function X(s,t){let u=t.split(".");t="";do t+=u.shift(),f(s)&&f(s[t])&&(y(s[t])||Z(s[t])||!u.length)?(s=s[t],t=""):u.length?t+=".":s=void 0;while(u.length);return s}function re(s,t,u){let e=t.split("."),n=s;for(let i=0;i<e.length;i++){let a=e[i];i===e.length-1?n[a]=u:((!n[a]||!y(n[a]))&&(n[a]={}),n=n[a])}}var g=class{},z=(()=>{let t=class t extends g{templateMatcher=/{{\s?([^{}\s]*)\s?}}/g;interpolate(e,n){if(Q(e))return this.interpolateString(e,n);if(ae(e))return this.interpolateFunction(e,n)}interpolateFunction(e,n){return e(n)}interpolateString(e,n){return n?e.replace(this.templateMatcher,(i,a)=>{let r=X(n,a);return f(r)?r:i}):e}};o(t,"\u0275fac",(()=>{let e;return function(i){return(e||(e=E(t)))(i||t)}})()),o(t,"\u0275prov",c({token:t,factory:t.\u0275fac}));let s=t;return s})(),p=class{},W=(()=>{let t=class t extends p{compile(e,n){return e}compileTranslations(e,n){return e}};o(t,"\u0275fac",(()=>{let e;return function(i){return(e||(e=E(t)))(i||t)}})()),o(t,"\u0275prov",c({token:t,factory:t.\u0275fac}));let s=t;return s})(),v=class{defaultLang;currentLang=this.defaultLang;translations={};langs=[];onTranslationChange=new j;onLangChange=new j;onDefaultLangChange=new j},V=new D("ISOLATE_TRANSLATE_SERVICE"),F=new D("USE_DEFAULT_LANG"),R=new D("DEFAULT_LANGUAGE"),P=new D("USE_EXTEND"),T=s=>L(s)?s:b(s),M=(()=>{let t=class t{store;currentLoader;compiler;parser;missingTranslationHandler;useDefaultLang;extend;loadingTranslations;pending=!1;_translationRequests={};lastUseLanguage=null;get onTranslationChange(){return this.store.onTranslationChange}get onLangChange(){return this.store.onLangChange}get onDefaultLangChange(){return this.store.onDefaultLangChange}get defaultLang(){return this.store.defaultLang}set defaultLang(e){this.store.defaultLang=e}get currentLang(){return this.store.currentLang}set currentLang(e){this.store.currentLang=e}get langs(){return this.store.langs}set langs(e){this.store.langs=e}get translations(){return this.store.translations}set translations(e){this.store.translations=e}constructor(e,n,i,a,r,N=!0,h=!1,w=!1,S){this.store=e,this.currentLoader=n,this.compiler=i,this.parser=a,this.missingTranslationHandler=r,this.useDefaultLang=N,this.extend=w,h&&(this.store=new v),S&&this.setDefaultLang(S)}setDefaultLang(e){if(e===this.defaultLang)return;let n=this.retrieveTranslations(e);typeof n<"u"?(this.defaultLang==null&&(this.defaultLang=e),n.pipe(m(1)).subscribe(()=>{this.changeDefaultLang(e)})):this.changeDefaultLang(e)}getDefaultLang(){return this.defaultLang}use(e){if(this.lastUseLanguage=e,e===this.currentLang)return b(this.translations[e]);this.currentLang||(this.currentLang=e);let n=this.retrieveTranslations(e);return L(n)?(n.pipe(m(1)).subscribe(()=>{this.changeLang(e)}),n):(this.changeLang(e),b(this.translations[e]))}changeLang(e){e===this.lastUseLanguage&&(this.currentLang=e,this.onLangChange.emit({lang:e,translations:this.translations[e]}),this.defaultLang==null&&this.changeDefaultLang(e))}retrieveTranslations(e){if(typeof this.translations[e]>"u"||this.extend)return this._translationRequests[e]=this._translationRequests[e]||this.loadAndCompileTranslations(e),this._translationRequests[e]}getTranslation(e){return this.loadAndCompileTranslations(e)}loadAndCompileTranslations(e){this.pending=!0;let n=this.currentLoader.getTranslation(e).pipe(B(1),m(1));return this.loadingTranslations=n.pipe(x(i=>this.compiler.compileTranslations(i,e)),B(1),m(1)),this.loadingTranslations.subscribe({next:i=>{this.translations[e]=this.extend&&this.translations[e]?K(K({},i),this.translations[e]):i,this.updateLangs(),this.pending=!1},error:i=>{this.pending=!1}}),n}setTranslation(e,n,i=!1){let a=this.compiler.compileTranslations(n,e);(i||this.extend)&&this.translations[e]?this.translations[e]=J(this.translations[e],a):this.translations[e]=a,this.updateLangs(),this.onTranslationChange.emit({lang:e,translations:this.translations[e]})}getLangs(){return this.langs}addLangs(e){let n=e.filter(i=>!this.langs.includes(i));n.length>0&&(this.langs=[...this.langs,...n])}updateLangs(){this.addLangs(Object.keys(this.translations))}getParsedResultForKey(e,n,i){let a;if(e&&(a=this.runInterpolation(X(e,n),i)),a===void 0&&this.defaultLang!=null&&this.defaultLang!==this.currentLang&&this.useDefaultLang&&(a=this.runInterpolation(X(this.translations[this.defaultLang],n),i)),a===void 0){let r={key:n,translateService:this};typeof i<"u"&&(r.interpolateParams=i),a=this.missingTranslationHandler.handle(r)}return a!==void 0?a:n}runInterpolation(e,n){if(Z(e))return e.map(i=>this.runInterpolation(i,n));if(y(e)){let i={};for(let a in e){let r=this.runInterpolation(e[a],n);r!==void 0&&(i[a]=r)}return i}else return this.parser.interpolate(e,n)}getParsedResult(e,n,i){if(n instanceof Array){let a={},r=!1;for(let h of n)a[h]=this.getParsedResultForKey(e,h,i),r=r||L(a[h]);if(!r)return a;let N=n.map(h=>T(a[h]));return Y(N).pipe(x(h=>{let w={};return h.forEach((S,ie)=>{w[n[ie]]=S}),w}))}return this.getParsedResultForKey(e,n,i)}get(e,n){if(!f(e)||!e.length)throw new Error('Parameter "key" is required and cannot be empty');return this.pending?this.loadingTranslations.pipe(k(i=>T(this.getParsedResult(i,e,n)))):T(this.getParsedResult(this.translations[this.currentLang],e,n))}getStreamOnTranslationChange(e,n){if(!f(e)||!e.length)throw new Error('Parameter "key" is required and cannot be empty');return O(U(()=>this.get(e,n)),this.onTranslationChange.pipe(G(i=>{let a=this.getParsedResult(i.translations,e,n);return T(a)})))}stream(e,n){if(!f(e)||!e.length)throw new Error('Parameter "key" required');return O(U(()=>this.get(e,n)),this.onLangChange.pipe(G(i=>{let a=this.getParsedResult(i.translations,e,n);return T(a)})))}instant(e,n){if(!f(e)||e.length===0)throw new Error('Parameter "key" is required and cannot be empty');let i=this.getParsedResult(this.translations[this.currentLang],e,n);return L(i)?Array.isArray(e)?e.reduce((a,r)=>(a[r]=r,a),{}):e:i}set(e,n,i=this.currentLang){re(this.translations[i],e,Q(n)?this.compiler.compile(n,i):this.compiler.compileTranslations(n,i)),this.updateLangs(),this.onTranslationChange.emit({lang:i,translations:this.translations[i]})}changeDefaultLang(e){this.defaultLang=e,this.onDefaultLangChange.emit({lang:e,translations:this.translations[e]})}reloadLang(e){return this.resetLang(e),this.loadAndCompileTranslations(e)}resetLang(e){delete this._translationRequests[e],delete this.translations[e]}getBrowserLang(){if(typeof window>"u"||!window.navigator)return;let e=this.getBrowserCultureLang();return e?e.split(/[-_]/)[0]:void 0}getBrowserCultureLang(){if(!(typeof window>"u"||typeof window.navigator>"u"))return window.navigator.languages?window.navigator.languages[0]:window.navigator.language||window.navigator.browserLanguage||window.navigator.userLanguage}};o(t,"\u0275fac",function(n){return new(n||t)(l(v),l(d),l(p),l(g),l(C),l(F),l(V),l(P),l(R))}),o(t,"\u0275prov",c({token:t,factory:t.\u0275fac,providedIn:"root"}));let s=t;return s})();var be=(()=>{let t=class t{translate;_ref;value="";lastKey=null;lastParams=[];onTranslationChange;onLangChange;onDefaultLangChange;constructor(e,n){this.translate=e,this._ref=n}updateValue(e,n,i){let a=r=>{this.value=r!==void 0?r:e,this.lastKey=e,this._ref.markForCheck()};if(i){let r=this.translate.getParsedResult(i,e,n);L(r)?r.subscribe(a):a(r)}this.translate.get(e,n).subscribe(a)}transform(e,...n){if(!e||!e.length)return e;if(I(e,this.lastKey)&&I(n,this.lastParams))return this.value;let i;if(f(n[0])&&n.length)if(Q(n[0])&&n[0].length){let a=n[0].replace(/(')?([a-zA-Z0-9_]+)(')?(\s)?:/g,'"$2":').replace(/:(\s)?(')(.*?)(')/g,':"$3"');try{i=JSON.parse(a)}catch(r){throw new SyntaxError(`Wrong parameter in TranslatePipe. Expected a valid Object, received: ${n[0]}`)}}else y(n[0])&&(i=n[0]);return this.lastKey=e,this.lastParams=n,this.updateValue(e,i),this._dispose(),this.onTranslationChange||(this.onTranslationChange=this.translate.onTranslationChange.subscribe(a=>{this.lastKey&&a.lang===this.translate.currentLang&&(this.lastKey=null,this.updateValue(e,i,a.translations))})),this.onLangChange||(this.onLangChange=this.translate.onLangChange.subscribe(a=>{this.lastKey&&(this.lastKey=null,this.updateValue(e,i,a.translations))})),this.onDefaultLangChange||(this.onDefaultLangChange=this.translate.onDefaultLangChange.subscribe(()=>{this.lastKey&&(this.lastKey=null,this.updateValue(e,i))})),this.value}_dispose(){typeof this.onTranslationChange<"u"&&(this.onTranslationChange.unsubscribe(),this.onTranslationChange=void 0),typeof this.onLangChange<"u"&&(this.onLangChange.unsubscribe(),this.onLangChange=void 0),typeof this.onDefaultLangChange<"u"&&(this.onDefaultLangChange.unsubscribe(),this.onDefaultLangChange=void 0)}ngOnDestroy(){this._dispose()}};o(t,"\u0275fac",function(n){return new(n||t)(H(M,16),H(se,16))}),o(t,"\u0275pipe",ne({name:"translate",type:t,pure:!1})),o(t,"\u0275prov",c({token:t,factory:t.\u0275fac}));let s=t;return s})();var me=(s={})=>ee([s.loader||{provide:d,useClass:$},s.compiler||{provide:p,useClass:W},s.parser||{provide:g,useClass:z},s.missingTranslationHandler||{provide:C,useClass:q},v,{provide:V,useValue:s.isolate},{provide:F,useValue:s.useDefaultLang},{provide:P,useValue:s.extend},{provide:R,useValue:s.defaultLanguage},M]),De=(()=>{let t=class t{static forRoot(e={}){return{ngModule:t,providers:[e.loader||{provide:d,useClass:$},e.compiler||{provide:p,useClass:W},e.parser||{provide:g,useClass:z},e.missingTranslationHandler||{provide:C,useClass:q},v,{provide:V,useValue:e.isolate},{provide:F,useValue:e.useDefaultLang},{provide:P,useValue:e.extend},{provide:R,useValue:e.defaultLanguage},M]}}static forChild(e={}){return{ngModule:t,providers:[e.loader||{provide:d,useClass:$},e.compiler||{provide:p,useClass:W},e.parser||{provide:g,useClass:z},e.missingTranslationHandler||{provide:C,useClass:q},{provide:V,useValue:e.isolate},{provide:F,useValue:e.useDefaultLang},{provide:P,useValue:e.extend},{provide:R,useValue:e.defaultLanguage},M]}}};o(t,"\u0275fac",function(n){return new(n||t)}),o(t,"\u0275mod",te({type:t})),o(t,"\u0275inj",_({}));let s=t;return s})();export{d as a,M as b,be as c,me as d,De as e};
