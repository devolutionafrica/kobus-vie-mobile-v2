import{c as f,g as j}from"./chunk-YZR4O2H4.js";import{Ba as v,Ga as z,Ib as J,Jb as W,La as S,N as E,Q as P,Ra as u,Sa as l,Ta as c,Ub as H,Xc as Z,_a as Y,gc as h,ib as d,kc as X,mc as p,ua as C,uc as K}from"./chunk-R3JMOR4V.js";import{a as B,b as M,h as L}from"./chunk-LNJ3S2LQ.js";var ae=(()=>{let t=class t{static formatDate(e,i="fr"){console.log("formatDate :::> ",e);let r=i=="fr"?e.split("-"):e.split("-").reverse();return new Date(parseInt(r[0]),parseInt(r[1])-1,parseInt(r[2]))}static getDateFr(e){let i=e.getDate(),r=e.getMonth()+1,a=e.getFullYear(),s=`${i}`.length===1?`0${i}`:i,m=`${r}`.length===1?`0${r}`:r;return`${s}/${m}/${a}`}static getDateEn(e){let i=e.getDate(),r=e.getMonth()+1,a=e.getFullYear(),s=`${i}`.length===1?`0${i}`:i,m=`${r}`.length===1?`0${r}`:r;return`${a}-${m}-${s}`}static getMinDateInContratArray(e){let i=new Date(e[0].detailContrat.dateSignature);for(let r of e){let a=new Date(r.detailContrat.dateSignature);a.getTime()<i.getTime()&&(i=a)}return i}static getContratCloseTime(e,i){let r=e.getDate(),a=e.getMonth(),s=e.getFullYear()+i;return new Date(s,a,r)}static createPdfByBase64(e){let i=window.atob(e),r=i.length,a=new Uint8Array(r);for(let s=0;s<r;s++)a[s]=i.charCodeAt(s);return a.buffer}static b64toBlob(e,i="",r=512){let a=atob(e),s=[];for(let g=0;g<a.length;g+=r){let b=a.slice(g,g+r),k=new Array(b.length);for(let x=0;x<b.length;x++)k[x]=b.charCodeAt(x);let ne=new Uint8Array(k);s.push(ne)}return new Blob(s,{type:i})}static generatePayRef(){let e=new Date().getTime();return"xxxx-IXP-xxx-xxxx".replace(/[xy]/g,r=>{let a=(e+Math.random()*16)%16|0;return e=Math.floor(e/16),(r==="x"?a:a&3|8).toString(16)})}static groupProduitByNature(e){return L(this,null,function*(){let i=[];return e.map(a=>a.natureProduit).filter((a,s,m)=>m.indexOf(a)===s).forEach(a=>{let s=e.filter(b=>b.natureProduit===a),m=e.find(b=>b.natureProduit===a).libelleNatureProduit,g={nature:a,libelle:m,data:s};i.push(g)}),yield i})}static sleep(e){return new Promise(i=>setTimeout(i,e))}};t.convertBase64ToBlob=e=>L(t,null,function*(){return yield(yield fetch(e)).blob()});let n=t;return n})();var ee=(()=>{let t=class t{constructor(){this.externalId="",this.afrikpay_account_username="uname",this.host="https://developers.api.oss.afrikpay.com",this.paymentForm=new X({referenceNumber:new p("",[h.required]),amount:new p("",[h.required,h.min(0)]),description:new p(""),email:new p("",[h.required,h.email]),phone:new p("",[h.required]),firstName:new p("",[h.required]),lastName:new p("",[h.required]),addressLine1:new p(""),addressCity:new p(""),addressState:new p(""),addressPostalCode:new p("")})}ngOnInit(){this.externalId=this.generateRandomString(),console.log("renderPaymentBtns",typeof renderPaymentBtns),console.log("Exteral Id : "+this.externalId,this.afrikpay_account_username,this.host),this.loadAfrikPayPayment()}generateRandomString(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZ",i="0123456789",r="";for(let s=0;s<10;s++){let m=e[Math.floor(Math.random()*e.length)],g=i[Math.floor(Math.random()*i.length)];s%2===0?r+=m:r+=g}return r}onSubmit(){this.paymentForm.valid?console.log("Form Submitted",this.paymentForm.value):console.log("Form is not valid")}loadAfrikPayPayment(){typeof renderPaymentBtns=="function"&&(console.log("Appel de fonction 1 : loadAfrikPayPayment"),renderPaymentBtns({externalId:this.externalId,username:this.afrikpay_account_username,formId:"form_id",paymentUrl:`${this.host}/api/secure/form/ecommerce/checkout/payment`,btnsContainerId:"buttons-container",btnClass:"btn btn-primary ms-2 mt-2",btnInlineStyleClass:"btn-style",methods:["orange-money-ecommerce-payment-service-feature","mtn-mobile-money-ecommerce-payment-service-feature"]}))}};t.\u0275fac=function(i){return new(i||t)},t.\u0275cmp=v({type:t,selectors:[["app-afrikpay-webview"]],inputs:{webviewData:"webviewData"},decls:52,vars:0,consts:[[1,"container","mx-auto"],[1,"row","d-flex","justify-content-center","mt-5"],["src","assets/images/pay_img/afrikpay.png","alt","",2,"width","180px"],[1,"row","d-flex","justify-content-center"],[1,"col-xs-12","col-sm-10","col-md-6","mt-3"],["id","form_id",1,"p-5"],[1,"mb-3","mt-3"],["for","referenceNumber",1,"form-label"],["type","text","value","237671696684","id","referenceNumber","placeholder","Veuillez entrer le num\xE9ro de r\xE9ference","name","referenceNumber","autocomplete","on",1,"form-control"],["for","amount",1,"form-label"],["type","number","id","amount","placeholder","Veuillez entrer le montant","name","amount","required","","autocomplete","on",1,"form-control"],["hidden","",1,"mb-3","mt-3"],["for","description",1,"form-label"],["type","text","id","description","placeholder","Veuillez entrer la description","name","description","autocomplete","on",1,"form-control"],["for","email",1,"form-label"],["type","email","id","email","placeholder","Veuillez entrer votre addresse email","name","email","autocomplete","on",1,"form-control"],["for","phone",1,"form-label"],["type","text","id","phone","placeholder","Veuillez entrer votre num\xE9ro de t\xE9l\xE9phone","name","phone","autocomplete","on",1,"form-control"],["for","firstName",1,"form-label"],["type","text","id","firstName","placeholder","Veuillez entrer votre Pr\xE9nom","name","data[firstName]","autocomplete","on",1,"form-control"],["for","lastName",1,"form-label"],["type","text","id","lastName","placeholder","Veuillez entrer votre Nom","name","data[lastName]","autocomplete","on",1,"form-control"],["for","addressLine1",1,"form-label"],["type","text","id","addressLine1","placeholder","Veuillez entrer votre addresse","name","data[addressLine1]","autocomplete","on",1,"form-control"],["for","addressCity",1,"form-label"],["type","text","id","addressCity","placeholder","Veuillez entrer votre Ville","name","data[addressCity]","autocomplete","on",1,"form-control"],["for","addressState",1,"form-label"],["type","text","id","addressState","placeholder","Veuillez entrer votre Pays","name","data[addressState]","autocomplete","on",1,"form-control"],["for","addressPostalCode",1,"form-label"],["type","text","id","addressPostalCode","placeholder","Veuillez entrer votre Code Postal","name","data[addressPostalCode]","autocomplete","on",1,"form-control"],[1,"text-center","px-4","px-md-3","mt-5"],["id","buttons-container",1,"row","d-flex","justify-content-center","align-items-center","flex-wrap","mt-2"]],template:function(i,r){i&1&&(u(0,"div",0)(1,"div",1),c(2,"img",2),l(),u(3,"div",3)(4,"div",4)(5,"form",5)(6,"div",6)(7,"label",7),d(8,"Num\xE9ro de t\xE9l\xE9phone"),l(),c(9,"input",8),l(),u(10,"div",6)(11,"label",9),d(12,"Montant"),l(),c(13,"input",10),l(),u(14,"div",11)(15,"label",12),d(16,"Description"),l(),c(17,"input",13),l(),u(18,"div",11)(19,"label",14),d(20,"Email"),l(),c(21,"input",15),l(),u(22,"div",11)(23,"label",16),d(24,"T\xE9l"),l(),c(25,"input",17),l(),u(26,"div",11)(27,"label",18),d(28,"Pr\xE9nom"),l(),c(29,"input",19),l(),u(30,"div",11)(31,"label",20),d(32,"Nom"),l(),c(33,"input",21),l(),u(34,"div",11)(35,"label",22),d(36,"Adresse"),l(),c(37,"input",23),l(),u(38,"div",11)(39,"label",24),d(40,"Ville"),l(),c(41,"input",25),l(),u(42,"div",11)(43,"label",26),d(44,"Pays"),l(),c(45,"input",27),l(),u(46,"div",11)(47,"label",28),d(48,"Code Postal"),l(),c(49,"input",29),l(),u(50,"div",30),c(51,"div",31),l()()()()())},styles:[".btn-style[_ngcontent-%COMP%]{margin-right:5px;width:50px;height:50px}"]});let n=t;return n})();function re(n,t){if(n&1&&(u(0,"div"),c(1,"app-afrikpay-webview",3),l()),n&2){let o=Y();C(),S("webviewData",o.payData)}}var he=(()=>{let t=class t{constructor(){}ngOnInit(){}};t.\u0275fac=function(i){return new(i||t)},t.\u0275cmp=v({type:t,selectors:[["webview-integrator"]],inputs:{payData:"payData",integrator:"integrator"},decls:3,vars:2,consts:[["fullscreen","true"],[3,"ngSwitch"],[4,"ngSwitchCase"],[3,"webviewData"]],template:function(i,r){i&1&&(u(0,"ion-content",0)(1,"div",1),z(2,re,2,1,"div",2),l()()),i&2&&(C(),S("ngSwitch",r.integrator),C(),S("ngSwitchCase","AfrikPay"))},dependencies:[Z,J,W,K,ee],styles:["#webviewBox[_ngcontent-%COMP%]{display:flex;align-items:center;flex-direction:column;justify-content:center;width:100%;height:100%}"]});let n=t;return n})();var w=class{static build(t){return[]}};var I=class{static build(t){return{valuerRachat:t.ValeurDeRachat,valeurRachatPGI:t.ValeurDeRachatPGI,capitalAuTerme:t.CapitalAuTerme,estimationCapital:t.Estimationducapital}}};var _=class{constructor(t,o,e,i,r,a,s,m){this._codeFiliale=t,this._libelleProduit=o,this._numeroQuittance=e,this._primePeriodique=i,this._numeroPolice=r,this._debutPeriode=a,this._finPeriode=s,this._etatQuittance=m,this._selected=!1}toJson(){return{codeFiliale:this._codeFiliale,libelleProduit:this._libelleProduit,numeroQuittance:this._numeroQuittance,primePeriodique:this._primePeriodique,numeroPolice:this._numeroPolice,debutPeriode:this._debutPeriode,finPeriode:this._finPeriode,etatQuittance:this._etatQuittance,selected:this._selected}}setSelected(t){this._selected=t}};var A=class{static build(t){let o=new _(t.CodeFiliale,t.LibelleProduit,t.NumeroQuittance,t.PrimePeriodique,t.NumeroPolice,t.DebutPeriode,t.FinPeriode,t.EtatQuittance);return o.setSelected(!1),o.toJson()}};var te=class{static build(t,o){let e=[];return t.Cotisation.find(r=>{(r.EtatQuittance===O.IMPAYE||r.EtatQuittance===O.PENDING_FOR_PROCESS)&&(console.log("EtatQuittance :::> ",r.EtatQuittance),e.push(A.build(M(B({},r),{selected:!1}))))}),M(B({},o),{_sinistre:w.build(t.Sinistre),_situation:I.build(t.Situation),_impayes:e})}},y=class{static build(t){var o=t.TermePoliceView;return o.MontantPrimePeriodique=t.RecapitulatiEtatCotisationPolice.MontantPrimePeriodique,o.CumuleDeCotisation=t.RecapitulatiEtatCotisationPolice.CumuleDeCotisation,{impayes:U.build(t.Impayes),garanties:q.build(t.GarantieViews),detailContrat:$.build(o),beneficiares:G.build(t.BeneficiairesViews),assureAssocie:D.build(t.AssureAssociesViews),prestationSinistres:Q.build(t.PrestationsSinistres)}}},R=class{static build(t){let o=[];for(let e of t.ListePolices)o.push(y.build(e));return{totalPrestationsCount:t.TotalPrestationsCount,totalMontantImpayes:t.TotalMontantImpayes,totalImpayeesCount:t.TotalImpayeesCount,totalQuittanceImpay\u00E9:t.NombreQuittanceImpaye,totalCount:t.TotalCount,data:o}}},U=class{static build(t){let o=[];for(let e of t.ListeImpayePoliceViews){let i={numeroQuittance:e.NumeroQuittance,montantQuittance:e.MontantQuittance,debutPeriode:e.DebutPeriode,finPeriode:e.FinPeriode,etatQuittance:e.EtatQuittance,numeroPolice:e.NumeroPolice,libellePolice:e.LibellePolice};o.push(i)}return{data:o,montantImpaye:t.TotalMontantImpayes,count:t.TotalCount}}},q=class{static build(t){let o=[];for(let e of t){let i={termePoliceGarantie:e.TermePoliceGarantieView};o.push(i)}return o}},$=class{static build(t){return{montantPrimePeriodique:t.MontantPrimePeriodique,cumuleDeCotisation:t.CumuleDeCotisation,dateEffet:t.DateEffet,uniteDuree:t.UniteDuree,dureePolice:parseInt(t.DureePolice),periodicite:t.Periodicite,dateEcheance:t.DateEcheance,numeroPolice:parseInt(t.NumeroPolice),libellePolice:t.LibellePolice,dateSignature:t.DateSignature,fractionnement:t.Fractionnement,numeroProposition:t.NumeroProposition,dureeRente:t.DureeRente,uniteDureeRente:t.UniteDureeRente,naturePolice:t.NaturePolice,statut:t.Statut}}},G=class{static build(t){let o=[];for(let e of t){let i={termeBeneficiaire:e.TermeBeneficiaireView,beneficiaire:e.Beneficiaire,repartition:e.Repartition,typeRisque:e.TypeRisque};o.push(i)}return o}},D=class{static build(t){let o=[];for(let e of t){let i={nomAssocie:e.NomAssocie,lienParente:e.LienParente,prenomAssocie:e.PrenomAssocie,numeroAssocie:e.NumeroAssocie,dateNaissanceAssocie:e.DateNaissanceAssocie};o.push(i)}return o}},Q=class{static build(t){let o=[];for(let e of t.ListePrestationSinistre){let i={numeroSinistre:e.NumeroSinistre,numeroPolice:e.NumeroPolice,cause:e.Cause,montantBrut:e.MontantBrut,demandeOperation:e.DemandeOperation,statut:e.Statut,dateOuverture:e.DateOuvertureSinistre,dateSurvenance:e.DateSurvenanceSinistre};o.push(i)}return{data:o,count:t.TotalCount}}},N=class{static build(t){let o=[];for(let e of t.ListeReglementSinsitreViews){let i={statut:e.Statut,assure:e.Assure,typeSinistre:e.TypeSinistre,typeDecompte:e.TypeDecompte,beneficiaire:e.Beneficiaire,etatReglement:e.EtatReglement,dateReglement:e.DateReglement,numeroTelephone:e.NumeroTelephone,numeroReglement:e.ModeReglementSouhaite,deviseReglement:e.DeviseReglement,personneSinistre:e.PersonneSinistre,montantReglement:e.MontantReglement,modeReglementSouhaite:e.ModeReglementSouhaite,numeroCompteReglement:e.NumeroCompteReglement};o.push(i)}return{data:o,count:t.TotalCount}}},T=class{static build(t){return{tauxToString:t.TauxEngagementGlobalPercent,taux:t.TauxEngagementGlobalValue}}},V=class{static build(t){return{montantTotalEncaisse:t.MontantTotalEncaisse,montantPrimePeriodique:t.MontantPrimePeriodique,montantTotalImpaye:t.MontantTotalImpaye,tauxToString:t.TauxCotisation,taux:t.TauxCotisationValeur}}},O=function(n){return n.SOLDEE="Sold\xE9e",n.IMPAYE="Quittance Emise non Sold\xE9e",n.REGULARISEE="R\xE9gularis\xE9e",n.PENDING_FOR_PROCESS="Attente retour banque",n}(O||{});var ie=(()=>{let t=class t{constructor(e,i){this._store=e,this._httpClient=i}listPoliceByUniqueClientNumber(e){let i=this._store.storeValue(f.FILIALE).souscriptionUrl;return this._httpClient.get(`${i}/GetPolicesClientUnique?numeroClientUnique=${e}`)}contratDetailByNumberPolice(e){let i={NumeroPolice:e},r=this._store.storeValue(f.FILIALE).souscriptionUrl;return this._httpClient.post(`${r}/DetailDescriptionPolice`,i)}getClientUniqueIndividuels(e){let i=this._store.storeValue(f.FILIALE).souscriptionUrl;return this._httpClient.post(`${i}/GetPorteuilleClientApporteur`,e)}searchClientApportIndividuel(e){let i=this._store.storeValue(f.FILIALE).souscriptionUrl;return this._httpClient.post(`${i}/GetClientUniqueIndividuels`,e)}countClientApportIndividuel(e){let i=this._store.storeValue(f.FILIALE).souscriptionUrl;return this._httpClient.get(`${i}/GetNombreClientIndividuelApporteur?numeroApporteur=${e}`)}getClientUniqueIndividuelsApporteur(e){let i=this._store.storeValue(f.FILIALE).souscriptionUrl;return this._httpClient.post(`${i}/GetPorteuilleClientApporteur`,e)}getReglementsPrestationByPolice(e){let i=this._store.storeValue(f.FILIALE).souscriptionUrl;return this._httpClient.post(`${i}/ReglementsPrestationByPolice`,e)}tauxEngagementByPolice(e){let i=this._store.storeValue(f.FILIALE).souscriptionUrl;return this._httpClient.get(`${i}/GetTauxEngagementPoliceIndividuelle?numeroPolice=${e}`)}tauxEngagementByUniqueClient(e){let i=this._store.storeValue(f.FILIALE).souscriptionUrl;return this._httpClient.get(`${i}/GetTauxEngagementGlobalIndividuelClientUnique?numeroClientUnique=${e}`)}};t.\u0275fac=function(i){return new(i||t)(P(j),P(H))},t.\u0275prov=E({token:t,factory:t.\u0275fac,providedIn:"root"});let n=t;return n})();var Te=(()=>{let t=class t{constructor(e){this._api=e}getDetailContrat(e){return this._api.contratDetailByNumberPolice(e).toPromise().then(i=>i.Success?{data:y.build(i),status:!0,message:""}:{data:null,status:!1,message:""}).catch(i=>i)}getUniqueClientContrats(e){return this._api.listPoliceByUniqueClientNumber(e).toPromise().then(i=>i.Success?{data:R.build(i),status:!0,message:""}:{data:null,status:!1,message:""}).catch(i=>i)}getReglementByPolice(e){return this._api.getReglementsPrestationByPolice(e).toPromise().then(i=>i.Success?{data:N.build(i),status:!0,message:""}:{data:null,status:!1,message:""}).catch(i=>i)}getReglementBySinistre(e){throw new Error("Method not implemented.")}getTauxEngagementByPolice(e){return this._api.tauxEngagementByPolice(e).toPromise().then(i=>(console.log(i),i.Success?{data:V.build(i.RecapitulatifEtatCotisationView),status:!0,message:""}:{data:null,status:!1,message:""})).catch(i=>i)}getGlobalTauxEngagementByUniqueClient(e){return this._api.tauxEngagementByUniqueClient(e).toPromise().then(i=>i.Success?{data:T.build(i),status:!0,message:""}:{data:null,status:!1,message:""}).catch(i=>i)}};t.\u0275fac=function(i){return new(i||t)(P(ie))},t.\u0275prov=E({token:t,factory:t.\u0275fac,providedIn:"root"});let n=t;return n})();export{ae as a,he as b,te as c,O as d,Te as e};
